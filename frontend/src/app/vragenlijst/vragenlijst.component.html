<div class="vragenlijst-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1 class="header-title">Vragenbeheer</h1>
      <p class="header-subtitle">
        Beheer alle vragen in het tevredenheidsonderzoek
      </p>
    </div>

    <!-- Statistieken -->
    <div class="stats-section">
      <div class="stat-card">
        <div class="stat-number">{{ totalQuestions }}</div>
        <div class="stat-label">Totaal vragen</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">{{ getQuestionCountByCategory("eten") }}</div>
        <div class="stat-label">Eten vragen</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">{{ getQuestionCountByCategory("zorg") }}</div>
        <div class="stat-label">Zorg vragen</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">
          {{ getQuestionCountByCategory("activiteiten") }}
        </div>
        <div class="stat-label">Activiteiten vragen</div>
      </div>
    </div>
  </div>

  <!-- Actiebalk -->
  <div class="action-bar">
    <button class="btn btn-primary" (click)="showAddQuestionForm()">
      <span class="btn-icon">+</span>
      Nieuwe vraag toevoegen
    </button>

    <div class="filters">
      <div class="search-box">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          placeholder="Zoek vragen..."
          class="search-input"
        />
        <span class="search-icon">ğŸ”</span>
      </div>

      <select
        [(ngModel)]="selectedCategory"
        (change)="onCategoryChange()"
        class="category-filter"
      >
        <option value="all">Alle categorieÃ«n</option>
        <option *ngFor="let category of categories" [value]="category.name">
          {{ getCategoryName(category.name) }} ({{
            getQuestionCountByCategory(category.name)
          }})
        </option>
      </select>
    </div>
  </div>

  <!-- Toevoeg/Bewerk Formulier -->
  <div *ngIf="showAddForm" class="form-section">
    <div class="form-card">
      <div class="form-header">
        <h3>
          {{ editingQuestion ? "Vraag bewerken" : "Nieuwe vraag toevoegen" }}
        </h3>
        <button class="btn-close" (click)="cancelEdit()">Ã—</button>
      </div>

      <div class="form-body">
        <div class="form-group">
          <label for="questionText" class="form-label">Vraag:</label>
          <textarea
            id="questionText"
            [(ngModel)]="newQuestion.question"
            placeholder="Voer de vraag in..."
            class="form-textarea"
            rows="3"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="questionCategory" class="form-label">Categorie:</label>
          <select
            id="questionCategory"
            [(ngModel)]="newQuestion.category"
            class="form-select"
          >
            <option *ngFor="let category of categories" [value]="category.name">
              {{ getCategoryName(category.name) }}
            </option>
          </select>
        </div>

        <div class="form-actions">
          <button
            class="btn btn-secondary"
            (click)="cancelEdit()"
            [disabled]="isSubmitting"
          >
            Annuleren
          </button>
          <button
            class="btn btn-primary"
            (click)="saveQuestion()"
            [disabled]="isSubmitting"
          >
            {{
              isSubmitting
                ? "Bezig met opslaan..."
                : editingQuestion
                ? "Opslaan"
                : "Toevoegen"
            }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading || areCategoriesLoading" class="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Vragen worden geladen...</p>
    </div>
  </div>

  <!-- Vragen Lijst -->
  <div *ngIf="!isLoading && !areCategoriesLoading" class="questions-container">
    <!-- Resultaat informatie -->
    <div class="results-info">
      <span class="results-count">
        Toon {{ getDisplayedRange() }} van {{ filteredQuestions.length }} vragen
      </span>
      <div class="page-size-selector">
        <label for="pageSize" class="page-size-label">Items per pagina:</label>
        <select
          id="pageSize"
          [(ngModel)]="pageSize"
          (change)="onPageSizeChange()"
          class="page-size-select"
        >
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="50">50</option>
        </select>
      </div>
    </div>

    <!-- Vragen Grid -->
    <div class="questions-grid">
      <div *ngFor="let question of paginatedQuestions" class="question-card">
        <div class="question-header">
          <div class="category-display">
            <span
              class="category-badge"
              [attr.data-category]="question.category"
            >
              {{ getCategoryName(question.category) }}
            </span>
          </div>
          <div class="question-actions">
            <button
              class="btn-icon btn-edit"
              (click)="editQuestion(question)"
              title="Bewerken"
            >
              âœï¸
            </button>
            <button
              class="btn-icon btn-delete"
              (click)="deleteQuestion(question.id)"
              title="Verwijderen"
            >
              ğŸ—‘ï¸
            </button>
          </div>
        </div>

        <div class="question-content" (click)="viewQuestion(question)">
          <h3 class="question-text">{{ question.question }}</h3>
        </div>

        <div class="question-footer">
          <button class="btn btn-outline" (click)="viewQuestion(question)">
            Bekijk details
          </button>
        </div>
      </div>
    </div>

    <!-- Paginatie Controls -->
    <div class="pagination-container" *ngIf="totalPages > 1">
      <div class="pagination">
        <button
          class="pagination-btn"
          [class.disabled]="currentPage === 1"
          (click)="goToPage(1)"
          title="Eerste pagina"
          [disabled]="currentPage === 1"
        >
          Â«Â«
        </button>

        <button
          class="pagination-btn"
          [class.disabled]="currentPage === 1"
          (click)="previousPage()"
          title="Vorige pagina"
          [disabled]="currentPage === 1"
        >
          Â«
        </button>

        <!-- Page Numbers -->
        <div class="page-numbers">
          <span *ngIf="showEllipsisStart" class="pagination-ellipsis">...</span>

          <button
            *ngFor="let page of getVisiblePages()"
            class="pagination-btn page-number"
            [class.active]="page === currentPage"
            (click)="goToPage(page)"
          >
            {{ page }}
          </button>

          <span *ngIf="showEllipsisEnd" class="pagination-ellipsis">...</span>
        </div>

        <button
          class="pagination-btn"
          [class.disabled]="currentPage === totalPages"
          (click)="nextPage()"
          title="Volgende pagina"
          [disabled]="currentPage === totalPages"
        >
          Â»
        </button>

        <button
          class="pagination-btn"
          [class.disabled]="currentPage === totalPages"
          (click)="goToPage(totalPages)"
          title="Laatste pagina"
          [disabled]="currentPage === totalPages"
        >
          Â»Â»
        </button>
      </div>

      <!-- Page Info -->
      <div class="page-info">Pagina {{ currentPage }} van {{ totalPages }}</div>
    </div>
  </div>

  <!-- Empty State -->
  <div
    *ngIf="
      !isLoading && !areCategoriesLoading && filteredQuestions.length === 0
    "
    class="empty-state"
  >
    <div
      class="empty-state-content"
      *ngIf="searchTerm || selectedCategory !== 'all'"
    >
      <div class="empty-state-icon">ğŸ”</div>
      <h3>Geen vragen gevonden</h3>
      <p>
        Geen vragen gevonden met de huidige filters. Probeer een andere zoekterm
        of categorie.
      </p>
      <button
        class="btn btn-primary"
        (click)="searchTerm = ''; selectedCategory = 'all'; applyFilters()"
      >
        Toon alle vragen
      </button>
    </div>
    <div
      class="empty-state-content"
      *ngIf="
        !searchTerm && selectedCategory === 'all' && questions.length === 0
      "
    >
      <div class="empty-state-icon">ğŸ“</div>
      <h3>Nog geen vragen</h3>
      <p>Er zijn nog geen vragen aangemaakt. Voeg uw eerste vraag toe!</p>
      <button class="btn btn-primary" (click)="showAddQuestionForm()">
        Eerste vraag toevoegen
      </button>
    </div>
  </div>
</div>
