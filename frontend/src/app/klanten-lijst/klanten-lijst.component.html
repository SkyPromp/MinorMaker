<div class="klanten-container">
  <div class="header-section">
    <h1 class="title">Cli√´ntenlijst</h1>
    <button class="add-btn" (click)="toggleAddForm()" [disabled]="isSubmitting">
      {{ showAddForm ? "Annuleer" : "+ Klant toevoegen" }}
    </button>
  </div>

  <!-- Error messages -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Add/Edit User Form -->
  <div *ngIf="showAddForm" class="add-user-form">
    <h2>
      {{ editingUserId !== null ? "Klant bewerken" : "Nieuwe klant toevoegen" }}
    </h2>

    <div class="form-group">
      <label for="firstname">Voornaam</label>
      <input
        type="text"
        id="firstname"
        [(ngModel)]="firstname"
        placeholder="Voer voornaam in"
        [disabled]="isSubmitting"
      />
    </div>

    <div class="form-group">
      <label for="lastname">Achternaam</label>
      <input
        type="text"
        id="lastname"
        [(ngModel)]="lastname"
        placeholder="Voer achternaam in"
        [disabled]="isSubmitting"
      />
    </div>

    <div class="form-group">
      <label for="role">Rol</label>
      <select id="role" [(ngModel)]="selectedRole" [disabled]="isSubmitting">
        <option [value]="RoleEnum.CLIENT">
          {{ getRoleName(RoleEnum.CLIENT) }}
        </option>
        <option [value]="RoleEnum.MEDEWERKER">
          {{ getRoleName(RoleEnum.MEDEWERKER) }}
        </option>
        <option [value]="RoleEnum.EXTERN">
          {{ getRoleName(RoleEnum.EXTERN) }}
        </option>
      </select>
    </div>

    <!-- Image Upload Section -->
    <div class="form-group">
      <label>Profielfoto</label>

      <!-- Current uploaded image or preview -->
      <div *ngIf="profileImageUrl || imagePreview" class="image-preview-container">
        <img [src]="profileImageUrl || imagePreview" alt="Profile image" class="uploaded-image" />
        <button
          type="button"
          class="remove-image-btn"
          (click)="removeImage()"
          [disabled]="isSubmitting || isUploadingImage"
        >
          ‚úï Verwijder
        </button>
      </div>

      <!-- File input -->
      <div class="file-input-container">
        <input
          type="file"
          id="imageUpload"
          accept="image/*"
          (change)="onFileSelected($event)"
          [disabled]="isSubmitting || isUploadingImage"
          #fileInput
        />
        <label for="imageUpload" class="file-input-label">
          üìÅ Selecteer afbeelding
        </label>
      </div>

      <!-- Status messages -->
<!--      <div *ngIf="isUploadingImage" class="upload-status">-->
<!--        <p>üì§ Afbeelding uploaden...</p>-->
<!--      </div>-->

<!--      <div *ngIf="selectedFile && !isUploadingImage" class="info-message">-->
<!--        <small>‚ÑπÔ∏è Afbeelding wordt ge√ºpload bij opslaan</small>-->
<!--      </div>-->

      <div *ngIf="profileImageUrl && !selectedFile" class="image-url-display">
        <small>‚úì Huidige profielfoto</small>
      </div>
    </div>

    <div class="form-actions">
      <button class="submit-btn" (click)="saveUser()" [disabled]="isSubmitting || isUploadingImage">
        {{ isUploadingImage ? "Uploaden..." : (isSubmitting ? "Aan het opslaan..." : "Opslaan") }}
      </button>
      <button
        class="cancel-btn"
        (click)="cancelEdit()"
        [disabled]="isSubmitting || isUploadingImage"
      >
        Annuleer
      </button>
    </div>
  </div>

  <!-- Loading state -->
  <div *ngIf="isLoading" class="loading">
    <p>Laden...</p>
  </div>

  <!-- Users grid -->
  <div *ngIf="!isLoading" class="user-grid">
    <div class="user-card" *ngFor="let user of users">
      <div class="avatar">
        <img *ngIf="user.imageUrl" [src]="user.imageUrl" alt="Profile" />
        <span *ngIf="!user.imageUrl">{{ user.firstName[0] }}{{ user.lastName[0] }}</span>
      </div>
      <div class="info">
        <h3>{{ user.firstName }} {{ user.lastName }}</h3>
        <p>{{ getRoleName(user.role) }}</p>
      </div>
      <div class="actions">
        <button
          class="edit-btn"
          (click)="editUser(user)"
          [disabled]="isSubmitting"
          title="Bewerk klant"
        >
          ‚úèÔ∏è
        </button>
        <button
          class="delete-btn"
          (click)="deleteUser(user.id)"
          [disabled]="isSubmitting"
          title="Verwijder klant"
        >
          üóëÔ∏è
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && users.length === 0" class="empty">
    <p>Geen klanten gevonden.</p>
  </div>
</div>
